<div class="q-election-item">
  <div class="q-election-item-text">
    <div class="s-font-text-s q-election-item-text-party">{item.name}</div>
    {#if item.projection && item.projection.bestGuess}
      <div class="s-font-note q-election-item-text-current">{item.projection.lower}â€“{item.projection.upper}%</div>
    {/if}
  </div>
  <div class="q-election-item-projection-bar">
    <div class="q-election-item-bar-color q-election-item-bar-color--fullwidth q-election-item-bar-color--slim s-color-gray-3"></div>
    <div class="q-election-item-bar-color q-election-item-bar-color--slim {item.colorClass}" style="width: {barWidthPositionLeftPercentage}%; {item.colorStyle}"></div>
    <div class="q-election-item-bar-color q-election-item-bar-color--projection {item.colorClass}" style="left: {barWidthPositionLeftPercentage}%; width: {barWidthPercentage}%; {item.colorStyle}"></div>
    <div class="q-election-item-dot-color {item.colorClass}" style="left: {dotPositionLeftPercentage}%; {item.colorStyle}"></div>
  </div>
</div>

<script>
  export default {
    computed: {
      barWidthPercentage: ({ item, maxProjection }) => {
        if (maxProjection === undefined || !item.projection || item.projection.lower === undefined || !item.projection.upper === undefined) {
          return 0;
        }
        return (item.projection.upper / maxProjection * 100) - (item.projection.lower / maxProjection * 100);
      },
      barWidthPositionLeftPercentage: ({ item, maxProjection }) => {
        if (maxProjection === undefined || !item.projection || item.projection.lower === undefined) {
          return 0;
        }
        return (item.projection.lower / maxProjection * 100);
      },
      dotPositionLeftPercentage: ({ item, maxProjection }) => {
        if (maxProjection === undefined || !item.projection || item.projection.bestGuess === undefined) {
          return 0;
        }
        return (item.projection.bestGuess / maxProjection * 100);
      }
    }
  }
</script>